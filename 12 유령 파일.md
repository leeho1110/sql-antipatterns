# 12. 유령 파일

- 혹시 이미지나 미디어 파일을 어떻게 저장하나요? 경로만 별도로 추출해 컬럼에 저장하고 있진 않나요?
- 여기엔 몇 가지 문제가 존재합니다.
    - 만약 경로를 저장하는 컬럼이 존재할 때 레코드가 지워진다면 어떻게 되나요? 혹시 사진도 같이 지워지나요? 아마 그렇지 않을겁니다. 결국 이미지 파일은 고아 파일이 되버리죠.
    - 커밋이나 롤백을 수행할 때도 문제가 발생합니다. 이미지 파일의 경로 변경이나 같은 경로의 파일 변경이 하나의 트랜잭션 안에서 라이프 사이클을 같이 하지 않기 때문이죠.
        - 경로를 바꿨으나 이미지가 올라가지 않은 경우, 이미지는 올라갔지만 경로가 바뀌지 않은 경우 모두 포함되죠.
    - 백업을 할 때도 데이터베이스와 파일 시스템을 같이 진행해야 합니다.
    - 데이터 타입도 일반적으로 문자열을 사용합니다. 따라서 경로 이름이 유효한지도, 실제로 존재하는지도 검증할 수 없습니다.
- 이를 어떻게 해결할 수 있을까요?
    - 만약 필요하다면 BLOB 타입을 사용할 수 있습니다. 즉 이미지 파일을 외부 파일 시스템이 아닌 데이터베이스 내부에 저장하는 것입니다.
    - 위에서 존재했던 모든 문제를 해결할 수 있습니다.
- 과연 실무에서도 사용할 수 있을지 궁금하군요.